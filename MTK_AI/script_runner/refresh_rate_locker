#!/system/bin/sh

# Apply refresh rate based on mode ID — exact logic from your XML
# Usage: ./apply_refresh_rate.sh <mode_id>

if [ -z "$1" ]; then
  echo "Usage: $0 <mode_id>"
  echo "Example: $0 2"
  echo ""
  echo "To list modes, run:"
  echo "  run display_modes.sh   # as defined in your system"
  exit 1
fi

MODE_ID="$1"

echo "[+] Applying refresh rate mode: $MODE_ID"

# Exact <set> block from your XML
if [ -n "$MODE_ID" ]; then
  service call SurfaceFlinger 1035 i32 "$MODE_ID"
  if [ $? -eq 0 ]; then
    echo "[✓] Success! Mode $MODE_ID applied."
  else
    echo "[!] Failed. Ensure root and compatible device."
  fi
else
  echo "[!] Empty mode ID — nothing applied."
fi